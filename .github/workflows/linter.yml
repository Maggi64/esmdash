name: "Code Checks"
on:
  pull_request :
    paths :
      - '**.js'
      - '**.ts'
      - '**.svelte'
    
jobs:
  eslint:
    runs-on: ubuntu-latest
    name: ESLint
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: ${{github.event.pull_request.head.ref}}
          repository: ${{github.event.pull_request.head.repo.full_name}}

      - name : Use Node.js 22.x
        uses : actions/setup-node@v4
        with :
          node-version : 22.x
          cache: npm

      - name: Install dependencies
        run: npm ci

      - name: Auto-fix ESLint errors
        run: npm run lint:fix || true
      - name: Commit auto-fixed ESLint errors
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
            commit_message: ðŸ”§ Auto-fix ESLint errors

      # only run if all files already auto fixed
      - name : Run eslint on changed files
        uses: a-b-r-o-w-n/eslint-action@v2
        with:
          repo-token: "${{ secrets.GITHUB_TOKEN }}"
          extensions: .js,.ts,.svelte
